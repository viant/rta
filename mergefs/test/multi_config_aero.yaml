Endpoint:
  Port: 8061

Debug: true #false #true
TypeName: github.com/viant/rta/mergefs/registry/ineligibility.Record
TimeoutSec:   3000
ThinkTimeSec: 5 #1 #5 #30 sec on prod
ThinkTimeJournalMs: 800

JournalTable: AUDIENCE_INELIGIBLE_RTA_JN
JournalConnection:
  Driver: mysql
  Dsn: 'root:dev@tcp(127.0.0.1:3307)/forecaster?parseTime=true'

# TODO - different mode
#Dest: audience_ineligible/Values
#Connection:
#  Driver: aerospike
#  Dsn: 'aerospike://127.0.0.1:3000/ns_memory'
#
#Mode: direct
#UseInsertAPI: true
#BatchSize: 30000
#CreateDDL: "REGISTER SET WITH TTL 259200 ${Dest} AS ${Struct}"

MainLoopDelayMs: 10
MergersRefreshMs: 15000
MaxJournalsInChunk: 2
ScannerBufferMB: 1
GCPercent: 50
#
#Merge:
#  AggregableSum:
#    - value

Collector:
  MaxMessageSize: 16
  Concurrency: 10
  StreamDisabled: true
  LoadDelayMaxMs: 3000
  LoadDelaySeedPart: 0 #DYNAMIC - CHECK FILTER INIT
  LoadDelayEveryNExec: 20
  LoadDelayOnlyOnce: true
  Batch:
    MaxDurationMs: 10000000000
    MaxElements:   10000000000
  Loader:
    Mode: direct
    Dest: audience_ineligible/Values
    CreateDDL: "REGISTER SET WITH TTL 259200 ${Dest} AS ${Struct} "
    OnDuplicateKeySql: "AS new ON DUPLICATE KEY UPDATE value = value + new.value"
    UseInsertAPI: true
    Connection:
      Driver: aerospike
      Dsn: 'aerospike://127.0.0.1:3000/ns_memory'
    BatchSize: 1000
  FastMapSize:    0 # TODO
  UseFastMap:     false # TODO
  Debug: true
  Mode: manual